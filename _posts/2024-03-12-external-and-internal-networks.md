---
title: windows中双网卡外网与内网如何同时使用
img_path: /assets/img/posts/20240312/
categories: [雕虫小技]
tags: []
---
有很多小伙伴们企业或者客户有专有网络，有时候需要远程客户电脑访问客户的内网服务时出现了外网连上后无法使用内网的情况：

## 使用`管理员`添加一条路由信息就搞定
```bash
# 这条命令作用就是添加一条路由信息，使ip地址10开头的访问走`10.4.50.110`这个网关
 route add 10.0.0.0 mask 255.0.0.0 10.4.50.110
# 永久生效 route -p add... 电脑重启后照样生效
# 删除 route delete 10.0.0.0 mask 255.0.0.0
```
* `10.0.0.0` 表示你要访问的内网ip地址，0为通配符
* `255.0.0.0` 这个解释太复杂，反正这样填写没毛病
* `10.4.50.110` 这个就是你连接`专网网卡的网关`

如果未成功请一起来学习下以下知识点

## tracert 命令使用
首先就是确认你的访问是走的那个网关出去的
```bash
C:\Users\Administrator>tracert baidu.com

通过最多 30 个跃点跟踪
到 baidu.com [39.156.66.10] 的路由:

  1     2 ms     2 ms     1 ms  192.168.20.1
  2     7 ms     8 ms     *     180.166.205.21
  3     *     ^C
```
1. 命令执行结果能看出我访问百度是从`192.168.20.1`这个网关出去的
2. 如果你使用这个命令查看内网ip地址访问情况，第一条后面就是出去的网关地址
3. 提供第一条记录的网关地址去确认是那一张网卡，外网应该走外网的网卡，内网应该走内网的网卡
  
## route print 命令使用
查看路由表：可以查看到刚新增成功的那条路由信息
```bash
C:\Users\Administrator>route print

IPv4 路由表
===========================================================================
活动路由:
网络目标        网络掩码          网关       接口   跃点数
          0.0.0.0          0.0.0.0     192.168.20.1    192.168.23.86     50
         10.0.0.0        255.0.0.0      10.4.50.110    192.168.23.86     51
        127.0.0.0        255.0.0.0            在链路上         127.0.0.1    331
        127.0.0.1  255.255.255.255            在链路上         127.0.0.1    331
  127.255.255.255  255.255.255.255            在链路上         127.0.0.1    331
```
* 第一条路由意思就是`0.0.0.0`表示所有ip地址的访问都走`192.168.20.1`这个网关
* 既然第一条路由就设置了所有ip访问了那么第二条路由如何生效呢？那么就是最后那个参数`活跃点`的作用了
* 活跃点一般自动的无需去配置，如果路由配置正确还是无法正常访问内网外网那可能需要手动配置下活跃点了
* 活跃点配置=>找到你的网卡右键属性=>Internet协议版本4=>右下角高级，将自动活跃勾选去掉然后值两张网卡对比着设置

## ipconfig 命令使用
这个就没必要详细讲解了，最常用的命令之一

最开始命令中需要个`网关`参数就是这个`默认网关`
```bash
C:\Users\Administrator>ipconfig

Windows IP 配置

无线局域网适配器 WLAN 3:

   连接特定的 DNS 后缀 . . . . . . . : SSG-140
   本地链接 IPv6 地址. . . . . . . . : fe80::9b42:2721:b0e4:3857%26
   IPv4 地址 . . . . . . . . . . . . : 192.168.23.86
   子网掩码  . . . . . . . . . . . . : 255.255.252.0
   默认网关. . . . . . . . . . . . . : 192.168.20.1

以太网适配器 vEthernet (Default Switch):

   连接特定的 DNS 后缀 . . . . . . . :
   本地链接 IPv6 地址. . . . . . . . : fe80::499f:1da0:6c34:a8ab%60
   IPv4 地址 . . . . . . . . . . . . : 172.25.16.10
   子网掩码  . . . . . . . . . . . . : 255.255.240.0
   默认网关. . . . . . . . . . . . . : 172.25.16.1
```


## 专网的ip地址段
私有 IP 地址范围用于在内部网络中分配，不直接路由到公共互联网  
没什么作用，就是让你知道一看到10开头的ip地址那就是内网的
* A 类地址范围：
范围：10.0.0.0 到 10.255.255.255  
默认子网掩码：255.0.0.0 或 /8  
例如：10.0.0.1、10.1.1.1、10.255.255.254
* B 类地址范围：
范围：172.16.0.0 到 172.31.255.255  
默认子网掩码：255.240.0.0 或 /12  
例如：172.16.0.1、172.31.255.254
* C 类地址范围：
范围：192.168.0.0 到 192.168.255.255  
默认子网掩码：255.255.0.0 或 /16  
例如：192.168.0.1、192.168.255.254
